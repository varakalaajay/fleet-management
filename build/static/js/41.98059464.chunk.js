"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[41],{705:function(e,t,n){var r=n(1413),i=n(890),a=n(533),o=(n(2791),n(184));t.Z=function(e){return(0,o.jsxs)(i.Z,(0,r.Z)((0,r.Z)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",(0,o.jsx)(a.Z,{color:"inherit",href:"https://infinite.com/",children:"Infinite"})," ",(new Date).getFullYear(),"."]}))}},41:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});n(1413);var r=n(2982),i=n(4165),a=n(5861),o=n(885),l=n(2791),s=n(8559),c=n.n(s),u=n(9961),d=n(5259),p=n(5987),f=n(5362),m=n(9359),h=n(150),g=["positions"],x=(0,f.Au)((function(e,t){var n=e.positions,r=(0,p.Z)(e,g),i=new s.Polygon(n,r);return(0,m.O)(i,(0,h.sj)(t,{overlayContainer:i}))}),(function(e,t,n){t.positions!==n.positions&&e.setLatLngs(t.positions)})),v=n(3407),Z=n(4993),j=n(8234),y=(n(3666),n(1396),n(4554)),b=n(4663),w=n(266),k=n(1889),_=n(5527),S=n(705),C=n(2388),I=n(8096),D=n(4925),O=n(8406),z=n(3786),L=n(184);delete c().Icon.Default.prototype._getIconUrl,c().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-icon.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/images/marker-shadow.png"});var U=function(){var e=(0,l.useState)({lat:37.350768,lng:-121.889488}),t=(0,o.Z)(e,2),n=t[0],s=(t[1],(0,l.useState)([])),c=(0,o.Z)(s,2),p=(c[0],c[1]),f=(0,l.useRef)(),m=localStorage.getItem("token"),h=localStorage.getItem("user"),g=(0,l.useState)([]),U=(0,o.Z)(g,2),E=U[0],P=U[1],T=(0,l.useState)({}),F=(0,o.Z)(T,2),R=(F[0],F[1],(0,l.useState)([17.45,78.38])),W=(0,o.Z)(R,2),$=(W[0],W[1],(0,l.useState)(null)),A=(0,o.Z)($,2),G=A[0],M=A[1],N=(0,l.useState)([]),V=(0,o.Z)(N,2),Y=V[0],q=V[1],B=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.Z)({method:"post",url:"http://54.226.199.64:8001/infinite/get_devices",headers:{"Content-Type":"application/octet-stream","x-token":m,"x-user":h}});case 2:t=e.sent,P(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){B()}),[]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(y.Z,{component:"main",sx:{backgroundColor:function(e){return"light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900]},flexGrow:1,height:"100vh",overflow:"auto"},children:[(0,L.jsx)(b.Z,{}),(0,L.jsxs)(w.Z,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,L.jsx)(k.ZP,{container:!0,spacing:3,children:(0,L.jsx)(k.ZP,{item:!0,xs:12,children:(0,L.jsxs)(_.Z,{sx:{p:2,display:"flex",flexDirection:"column",height:"350"},children:[(0,L.jsx)(y.Z,{component:"form",noValidate:!0,sx:{mt:1},children:(0,L.jsxs)(I.Z,{sx:{m:1,minWidth:200},size:"small",children:[(0,L.jsx)(D.Z,{id:"demo-select-small",children:"Select Device"}),(0,L.jsx)(O.Z,{labelId:"demo-select-small",id:"demo-select-small",value:G,label:"Select Device",size:"small",onChange:function(e){M(e.target.value);var t=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(){var n,r,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,C.Z)({method:"post",url:"http://54.226.199.64:8001/infinite/get_geofence",headers:{"Content-Type":"application/octet-stream","x-token":m,"x-user":h},params:{device_id:e.target.value}});case 2:n=t.sent,r=n.data,a=Object.values(r).map((function(e){return e.slice(1,-1).split(", ").map(Number)})),q([{id:1,latlngs:a}]);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()},children:E.map((function(e){return(0,L.jsx)(z.Z,{value:e.device_id,children:e.device_id},e.device_id)}))})]})}),null===G?null:(0,L.jsxs)(u.h,{style:{width:"100%",height:"70vh"},center:n,zoom:6,ref:f,children:[(0,L.jsxs)(d.$,{children:[(0,L.jsx)(Z.$,{position:"topright",onCreated:function(e){console.log(e);var t=e.layerType,n=e.layer;if(console.log(n),"polygon"===t){var i=n._leaflet_id;p((function(e){return[].concat((0,r.Z)(e),[{id:i,latlngs:n.getLatLngs()[0]}])}))}},onEdited:function(e){return function(e){var t=Object.values(e._layers).map((function(e){var t=e._latlngs[0].map((function(e){return[e.lat,e.lng]}));return{id:e.options.id,latlngs:t}}));console.log(t),t.forEach((function(e){q((function(t){return t.map((function(t){return t.id===e.id?{id:e.id,latlngs:e.latlngs}:t}))}))}))}(e.layers)},onDeleted:function(e){console.log(e);var t=e.layers._layers;Object.values(t).map((function(e){var t=e._leaflet_id;p((function(e){return e.filter((function(e){return e.id!==t}))}))}))},draw:{rectangle:!1,polyline:!1,circle:!1,circlemarker:!1,marker:!1}}),null===Y||void 0===Y?void 0:Y.map((function(e){return(0,L.jsx)(x,{id:e.id,positions:e.latlngs,pathOptions:{color:1===e.id?"red":"blue"}},e.id)}))]}),(0,L.jsx)(v.I,{url:j.Z.maptiler.url,attribution:j.Z.maptiler.attribution})]})]})})}),(0,L.jsx)(S.Z,{sx:{pt:4}})]})]})})}},8234:function(e,t){t.Z={maptiler:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}}}}]);
//# sourceMappingURL=41.98059464.chunk.js.map